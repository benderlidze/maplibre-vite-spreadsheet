const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/maplibre-gl-Ir-3aF33.js","assets/index-DGN6YQuC.js","assets/index-BCXFgBop.css"])))=>i.map(i=>d[i]);
import{r as h,_ as We,a as qe,g as Ze,j as G}from"./index-DGN6YQuC.js";const zt={dataURL:"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ1RLwN8Q0x34xLsVAnqlRaTVWT6gezOa4O87UYgpCz137eIiZ7zHnNbEPi6ELEPgpKQoehHxse74n-/pub?output=csv",latField:"",lngField:"",nameField:"name",descField:"description",mapStyle:"Light",pinColor:"007cbf",mapCenter:[0,0],mapZoom:1,mapPitch:0,mapBearing:0},Ve=h.createContext(null);function Ke(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,i=Array.isArray(e)?e[1]:e?e.y:0,s=Array.isArray(t)?t[0]:t?t.x:0,a=Array.isArray(t)?t[1]:t?t.y:0;return n===s&&i===a}function re(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!re(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const s of n)if(!t.hasOwnProperty(s)||!re(e[s],t[s]))return!1;return!0}return!1}function Te(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function Fe(e,t){const n=t.viewState||t,i={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const s=e.center.constructor;i.center=new s(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(i.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(i.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(i.pitch=n.pitch),n.padding&&e.padding&&!re(n.padding,e.padding)&&(i.padding=n.padding),i}const $e=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ie(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const i of e.layers)t[i.id]=i;const n=e.layers.map(i=>{let s=null;"interactive"in i&&(s=Object.assign({},i),delete s.interactive);const a=t[i.ref];if(a){s=s||Object.assign({},i),delete s.ref;for(const l of $e)l in a&&(s[l]=a[l])}return s||i});return{...e,layers:n}}const Ae={version:8,sources:{},layers:[]},je={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},De={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Ne={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Qe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Je=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _e{constructor(t,n,i){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=s=>{const a=this.props[Ne[s.type]];a?a(s):s.type==="error"&&console.error(s.error)},this._onCameraEvent=s=>{if(this._internalUpdate)return;s.viewState=this._propsedCameraUpdate||Te(this._map.transform);const a=this.props[De[s.type]];a&&a(s)},this._onCameraUpdate=s=>this._internalUpdate?s:(this._propsedCameraUpdate=Te(s),Fe(s,this.props)),this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const a=this.props[je[s.type]];a&&(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"&&(s.features=this._hoveredFeatures||this._queryRenderedFeatures(s.point)),a(s),delete s.features)},this._MapClass=t,this.props=n,this._initialize(i)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const i=this._updateSettings(t,n),s=this._updateSize(t),a=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(i||s||a&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const i=_e.savedMaps.pop();if(!i)return null;const s=i.map,a=s.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);s._container=n;const l=s._resizeObserver;l&&(l.disconnect(),l.observe(n)),i.setProps({...t,styleDiffing:!1}),s.resize();const{initialViewState:f}=t;return f&&(f.bounds?s.fitBounds(f.bounds,{...f.fitBoundsOptions,duration:0}):i._updateViewState(f)),s.isStyleLoaded()?s.fire("load"):s.once("style.load",()=>s.fire("load")),s._update(),i}_initialize(t){const{props:n}=this,{mapStyle:i=Ae}=n,s={...n,...n.initialViewState,container:t,style:Ie(i)},a=s.initialViewState||s.viewState||s;if(Object.assign(s,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const f=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=f,n.gl)}const l=new this._MapClass(s);a.padding&&l.setPadding(a.padding),n.cursor&&(l.getCanvas().style.cursor=n.cursor),l.transformCameraUpdate=this._onCameraUpdate,l.on("style.load",()=>{var f;this._styleComponents={light:l.getLight(),sky:l.getSky(),projection:(f=l.getProjection)==null?void 0:f.call(l),terrain:l.getTerrain()},this._updateStyleComponents(this.props)}),l.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const f in je)l.on(f,this._onPointerEvent);for(const f in De)l.on(f,this._onCameraEvent);for(const f in Ne)l.on(f,this._onEvent);this._map=l}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),_e.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(t){const n=this._map,i=n.transform;if(!n.isMoving()){const a=Fe(i,t);if(Object.keys(a).length>0)return this._internalUpdate=!0,n.jumpTo(a),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const i=this._map;let s=!1;for(const a of Qe)if(a in t&&!re(t[a],n[a])){s=!0;const l=i[`set${a[0].toUpperCase()}${a.slice(1)}`];l==null||l.call(i,t[a])}return s}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:i=Ae,styleDiffing:s=!0}=t,a={diff:s};"localIdeographFontFamily"in t&&(a.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(Ie(i),a)}}_updateStyleComponents({light:t,projection:n,sky:i,terrain:s}){var f,p;const a=this._map,l=this._styleComponents;a.style._loaded&&(t&&!re(t,l.light)&&(l.light=t,a.setLight(t)),n&&!re(n,l.projection)&&n!==((f=l.projection)==null?void 0:f.type)&&(l.projection=typeof n=="string"?{type:n}:n,(p=a.setProjection)==null||p.call(a,l.projection)),i&&!re(i,l.sky)&&(l.sky=i,a.setSky(i)),s!==void 0&&!re(s,l.terrain)&&(!s||a.getSource(s.source))&&(l.terrain=s,a.setTerrain(s)))}_updateHandlers(t,n){const i=this._map;for(const s of Je){const a=t[s]??!0,l=n[s]??!0;re(a,l)||(a?i[s].enable(a):i[s].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:i=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var s;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=t.type,l=((s=this._hoveredFeatures)==null?void 0:s.length)>0,f=this._queryRenderedFeatures(t.point),p=f.length>0;!p&&l&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=f,p&&!l&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=a}else this._hoveredFeatures=null}}_e.savedMaps=[];const Ye=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Ge(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const i of Xe(t))!(i in n)&&!Ye.includes(i)&&(n[i]=t[i].bind(t));return n}function Xe(e){const t=new Set;let n=e;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof e[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&t.add(i);n=Object.getPrototypeOf(n)}return Array.from(t)}const et=typeof document<"u"?h.useLayoutEffect:h.useEffect;function tt(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:i,workerCount:s,workerUrl:a}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:l,lazy:f=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(l,p=>{p&&console.error(p)},f)}i!==void 0&&e.setMaxParallelImageRequests(i),s!==void 0&&e.setWorkerCount(s),a!==void 0&&e.setWorkerUrl(a)}const ve=h.createContext(null);function nt(e,t){const n=h.useContext(Ve),[i,s]=h.useState(null),a=h.useRef(),{current:l}=h.useRef({mapLib:null,map:null});h.useEffect(()=>{const u=e.mapLib;let w=!0,d;return Promise.resolve(u||We(()=>import("./maplibre-gl-Ir-3aF33.js").then(S=>S.m),__vite__mapDeps([0,1,2]))).then(S=>{if(!w)return;if(!S)throw new Error("Invalid mapLib");const I="Map"in S?S:S.default;if(!I.Map)throw new Error("Invalid mapLib");if(tt(I,e),!I.supported||I.supported(e))e.reuseMaps&&(d=_e.reuse(e,a.current)),d||(d=new _e(I.Map,e,a.current)),l.map=Ge(d),l.mapLib=I,s(d),n==null||n.onMapMount(l.map,e.id);else throw new Error("Map is not supported by this browser")}).catch(S=>{const{onError:I}=e;I?I({type:"error",target:null,originalEvent:null,error:S}):console.error(S)}),()=>{w=!1,d&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?d.recycle():d.destroy())}},[]),et(()=>{i&&i.setProps(e)}),h.useImperativeHandle(t,()=>l.map,[i]);const f=h.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),p={height:"100%"};return h.createElement("div",{id:e.id,ref:a,style:f},i&&h.createElement(ve.Provider,{value:l},h.createElement("div",{"mapboxgl-children":"",style:p},e.children)))}const rt=h.forwardRef(nt),it=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function he(e,t){if(!e||!t)return;const n=e.style;for(const i in t){const s=t[i];Number.isFinite(s)&&!it.test(i)?n[i]=`${s}px`:n[i]=s}}h.memo(h.forwardRef((e,t)=>{const{map:n,mapLib:i}=h.useContext(ve),s=h.useRef({props:e});s.current.props=e;const a=h.useMemo(()=>{let b=!1;h.Children.forEach(e.children,$=>{$&&(b=!0)});const j={...e,element:b?document.createElement("div"):null},N=new i.Marker(j);return N.setLngLat([e.longitude,e.latitude]),N.getElement().addEventListener("click",$=>{var q,Q;(Q=(q=s.current.props).onClick)==null||Q.call(q,{type:"click",target:N,originalEvent:$})}),N.on("dragstart",$=>{var Q,J;const q=$;q.lngLat=a.getLngLat(),(J=(Q=s.current.props).onDragStart)==null||J.call(Q,q)}),N.on("drag",$=>{var Q,J;const q=$;q.lngLat=a.getLngLat(),(J=(Q=s.current.props).onDrag)==null||J.call(Q,q)}),N.on("dragend",$=>{var Q,J;const q=$;q.lngLat=a.getLngLat(),(J=(Q=s.current.props).onDragEnd)==null||J.call(Q,q)}),N},[]);h.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:l,latitude:f,offset:p,style:u,draggable:w=!1,popup:d=null,rotation:S=0,rotationAlignment:I="auto",pitchAlignment:O="auto"}=e;return h.useEffect(()=>{he(a.getElement(),u)},[u]),h.useImperativeHandle(t,()=>a,[]),(a.getLngLat().lng!==l||a.getLngLat().lat!==f)&&a.setLngLat([l,f]),p&&!Ke(a.getOffset(),p)&&a.setOffset(p),a.isDraggable()!==w&&a.setDraggable(w),a.getRotation()!==S&&a.setRotation(S),a.getRotationAlignment()!==I&&a.setRotationAlignment(I),a.getPitchAlignment()!==O&&a.setPitchAlignment(O),a.getPopup()!==d&&a.setPopup(d),qe.createPortal(e.children,a.getElement())}));function Pe(e){return new Set(e?e.trim().split(/\s+/):[])}const ot=h.memo(h.forwardRef((e,t)=>{const{map:n,mapLib:i}=h.useContext(ve),s=h.useMemo(()=>document.createElement("div"),[]),a=h.useRef({props:e});a.current.props=e;const l=h.useMemo(()=>{const f={...e},p=new i.Popup(f);return p.setLngLat([e.longitude,e.latitude]),p.once("open",u=>{var w,d;(d=(w=a.current.props).onOpen)==null||d.call(w,u)}),p},[]);if(h.useEffect(()=>{const f=p=>{var u,w;(w=(u=a.current.props).onClose)==null||w.call(u,p)};return l.on("close",f),l.setDOMContent(s).addTo(n.getMap()),()=>{l.off("close",f),l.isOpen()&&l.remove()}},[]),h.useEffect(()=>{he(l.getElement(),e.style)},[e.style]),h.useImperativeHandle(t,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==e.longitude||l.getLngLat().lat!==e.latitude)&&l.setLngLat([e.longitude,e.latitude]),e.offset&&!re(l.options.offset,e.offset)&&l.setOffset(e.offset),(l.options.anchor!==e.anchor||l.options.maxWidth!==e.maxWidth)&&(l.options.anchor=e.anchor,l.setMaxWidth(e.maxWidth)),l.options.className!==e.className)){const f=Pe(l.options.className),p=Pe(e.className);for(const u of f)p.has(u)||l.removeClassName(u);for(const u of p)f.has(u)||l.addClassName(u);l.options.className=e.className}return qe.createPortal(e.children,s)}));function ge(e,t,n,i){const s=h.useContext(ve),a=h.useMemo(()=>e(s),[]);return h.useEffect(()=>{const l=t,f=null,p=typeof t=="function"?t:null,{map:u}=s;return u.hasControl(a)||(u.addControl(a,l==null?void 0:l.position),f&&f(s)),()=>{p&&p(s),u.hasControl(a)&&u.removeControl(a)}},[]),a}function st(e){const t=ge(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return h.useEffect(()=>{he(t._container,e.style)},[e.style]),null}h.memo(st);function at(e){const t=ge(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return h.useEffect(()=>{he(t._controlContainer,e.style)},[e.style]),null}h.memo(at);function lt(e,t){const n=h.useRef({props:e}),i=ge(({mapLib:s})=>{const a=new s.GeolocateControl(e),l=a._setupUI;return a._setupUI=()=>{a._container.hasChildNodes()||l()},a.on("geolocate",f=>{var p,u;(u=(p=n.current.props).onGeolocate)==null||u.call(p,f)}),a.on("error",f=>{var p,u;(u=(p=n.current.props).onError)==null||u.call(p,f)}),a.on("outofmaxbounds",f=>{var p,u;(u=(p=n.current.props).onOutOfMaxBounds)==null||u.call(p,f)}),a.on("trackuserlocationstart",f=>{var p,u;(u=(p=n.current.props).onTrackUserLocationStart)==null||u.call(p,f)}),a.on("trackuserlocationend",f=>{var p,u;(u=(p=n.current.props).onTrackUserLocationEnd)==null||u.call(p,f)}),a},{position:e.position});return n.current.props=e,h.useImperativeHandle(t,()=>i,[]),h.useEffect(()=>{he(i._container,e.style)},[e.style]),null}h.memo(h.forwardRef(lt));function ut(e){const t=ge(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return h.useEffect(()=>{he(t._container,e.style)},[e.style]),null}const ct=h.memo(ut);function ft(e){const t=ge(({mapLib:a})=>new a.ScaleControl(e),{position:e.position}),n=h.useRef(e),i=n.current;n.current=e;const{style:s}=e;return e.maxWidth!==void 0&&e.maxWidth!==i.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==i.unit&&t.setUnit(e.unit),h.useEffect(()=>{he(t._container,s)},[s]),null}h.memo(ft);function dt(e){const t=ge(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return h.useEffect(()=>{he(t._container,e.style)},[e.style]),null}h.memo(dt);function ht(e){const t=ge(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return h.useEffect(()=>{he(t._container,e.style)},[e.style]),null}h.memo(ht);function Se(e,t){if(!e)throw new Error(t)}let pt=0;function gt(e,t,n){if(e.style&&e.style._loaded){const i={...n};return delete i.id,delete i.children,e.addSource(t,i),e.getSource(t)}return null}function mt(e,t,n){var l,f,p;Se(t.id===n.id,"source id changed"),Se(t.type===n.type,"source type changed");let i="",s=0;for(const u in t)u!=="children"&&u!=="id"&&!re(n[u],t[u])&&(i=u,s++);if(!s)return;const a=t.type;if(a==="geojson")e.setData(t.data);else if(a==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(i){case"coordinates":(l=e.setCoordinates)==null||l.call(e,t.coordinates);break;case"url":(f=e.setUrl)==null||f.call(e,t.url);break;case"tiles":(p=e.setTiles)==null||p.call(e,t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${i}`)}}function yt(e){const t=h.useContext(ve).map.getMap(),n=h.useRef(e),[,i]=h.useState(0),s=h.useMemo(()=>e.id||`jsx-source-${pt++}`,[]);h.useEffect(()=>{if(t){const l=()=>setTimeout(()=>i(f=>f+1),0);return t.on("styledata",l),l(),()=>{var f;if(t.off("styledata",l),t.style&&t.style._loaded&&t.getSource(s)){const p=(f=t.getStyle())==null?void 0:f.layers;if(p)for(const u of p)u.source===s&&t.removeLayer(u.id);t.removeSource(s)}}}},[t]);let a=t&&t.style&&t.getSource(s);return a?mt(a,e,n.current):a=gt(t,s,e),n.current=e,a&&h.Children.map(e.children,l=>l&&h.cloneElement(l,{source:s}))||null}function _t(e,t,n,i){if(Se(n.id===i.id,"layer id changed"),Se(n.type===i.type,"layer type changed"),n.type==="custom"||i.type==="custom")return;const{layout:s={},paint:a={},filter:l,minzoom:f,maxzoom:p,beforeId:u}=n;if(u!==i.beforeId&&e.moveLayer(t,u),s!==i.layout){const w=i.layout||{};for(const d in s)re(s[d],w[d])||e.setLayoutProperty(t,d,s[d]);for(const d in w)s.hasOwnProperty(d)||e.setLayoutProperty(t,d,void 0)}if(a!==i.paint){const w=i.paint||{};for(const d in a)re(a[d],w[d])||e.setPaintProperty(t,d,a[d]);for(const d in w)a.hasOwnProperty(d)||e.setPaintProperty(t,d,void 0)}re(l,i.filter)||e.setFilter(t,l),(f!==i.minzoom||p!==i.maxzoom)&&e.setLayerZoomRange(t,f,p)}function vt(e,t,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const i={...n,id:t};delete i.beforeId,e.addLayer(i,n.beforeId)}}let Ct=0;function Et(e){const t=h.useContext(ve).map.getMap(),n=h.useRef(e),[,i]=h.useState(0),s=h.useMemo(()=>e.id||`jsx-layer-${Ct++}`,[]);if(h.useEffect(()=>{if(t){const l=()=>i(f=>f+1);return t.on("styledata",l),l(),()=>{t.off("styledata",l),t.style&&t.style._loaded&&t.getLayer(s)&&t.removeLayer(s)}}},[t]),t&&t.style&&t.getLayer(s))try{_t(t,s,e,n.current)}catch(l){console.warn(l)}else vt(t,s,e);return n.current=e,null}const bt={Dark:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",Light:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",Voyager:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",Contrast:"https://demotiles.maplibre.org/style.json",OSM:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"osm-layer",type:"raster",source:"osm"}]}};var ze={},xe={},Re=34,be=10,Le=13;function Be(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function wt(e,t){var n=Be(e);return function(i,s){return t(n(i),s,e)}}function Ue(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var s in i)s in t||n.push(t[s]=s)}),n}function ne(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function St(e){return e<0?"-"+ne(-e,6):e>9999?"+"+ne(e,6):ne(e,4)}function kt(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":St(e.getUTCFullYear())+"-"+ne(e.getUTCMonth()+1,2)+"-"+ne(e.getUTCDate(),2)+(s?"T"+ne(t,2)+":"+ne(n,2)+":"+ne(i,2)+"."+ne(s,3)+"Z":i?"T"+ne(t,2)+":"+ne(n,2)+":"+ne(i,2)+"Z":n||t?"T"+ne(t,2)+":"+ne(n,2)+"Z":"")}function xt(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(d,S){var I,O,b=s(d,function(j,N){if(I)return I(j,N-1);O=j,I=S?wt(j,S):Be(j)});return b.columns=O||[],b}function s(d,S){var I=[],O=d.length,b=0,j=0,N,$=O<=0,q=!1;d.charCodeAt(O-1)===be&&--O,d.charCodeAt(O-1)===Le&&--O;function Q(){if($)return xe;if(q)return q=!1,ze;var ie,T=b,r;if(d.charCodeAt(T)===Re){for(;b++<O&&d.charCodeAt(b)!==Re||d.charCodeAt(++b)===Re;);return(ie=b)>=O?$=!0:(r=d.charCodeAt(b++))===be?q=!0:r===Le&&(q=!0,d.charCodeAt(b)===be&&++b),d.slice(T+1,ie-1).replace(/""/g,'"')}for(;b<O;){if((r=d.charCodeAt(ie=b++))===be)q=!0;else if(r===Le)q=!0,d.charCodeAt(b)===be&&++b;else if(r!==n)continue;return d.slice(T,ie)}return $=!0,d.slice(T,O)}for(;(N=Q())!==xe;){for(var J=[];N!==ze&&N!==xe;)J.push(N),N=Q();S&&(J=S(J,j++))==null||I.push(J)}return I}function a(d,S){return d.map(function(I){return S.map(function(O){return w(I[O])}).join(e)})}function l(d,S){return S==null&&(S=Ue(d)),[S.map(w).join(e)].concat(a(d,S)).join(`
`)}function f(d,S){return S==null&&(S=Ue(d)),a(d,S).join(`
`)}function p(d){return d.map(u).join(`
`)}function u(d){return d.map(w).join(e)}function w(d){return d==null?"":d instanceof Date?kt(d):t.test(d+="")?'"'+d.replace(/"/g,'""')+'"':d}return{parse:i,parseRows:s,format:l,formatBody:f,formatRows:p,formatRow:u,formatValue:w}}var Rt=xt(","),Lt=Rt.parse;function Mt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Ot(e,t){return fetch(e,t).then(Mt)}function Tt(e){return function(t,n,i){return arguments.length===2&&typeof n=="function"&&(i=n,n=void 0),Ot(t,n).then(function(s){return e(s,i)})}}var Ft=Tt(Lt),we={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var It=we.exports,He;function At(){return He||(He=1,function(e,t){((n,i)=>{e.exports=i()})(It,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},s,a=!i.document&&!!i.postMessage,l=i.IS_PAPA_WORKER||!1,f={},p=0,u={};function w(r){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(o){var c=J(o);c.chunkSize=parseInt(c.chunkSize),o.step||o.chunk||(c.chunkSize=null),this._handle=new b(c),(this._handle.streamer=this)._config=c}).call(this,r),this.parseChunk=function(o,c){var m=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<m){let k=this._config.newline;k||(g=this._config.quoteChar||'"',k=this._handle.guessLineEndings(o,g)),o=[...o.split(k).slice(m)].join(k)}this.isFirstChunk&&T(this._config.beforeFirstChunk)&&(g=this._config.beforeFirstChunk(o))!==void 0&&(o=g),this.isFirstChunk=!1,this._halted=!1;var m=this._partialLine+o,g=(this._partialLine="",this._handle.parse(m,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(o=g.meta.cursor,m=(this._finished||(this._partialLine=m.substring(o-this._baseIndex),this._baseIndex=o),g&&g.data&&(this._rowCount+=g.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)i.postMessage({results:g,workerId:u.WORKER_ID,finished:m});else if(T(this._config.chunk)&&!c){if(this._config.chunk(g,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=g=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(g.data),this._completeResults.errors=this._completeResults.errors.concat(g.errors),this._completeResults.meta=g.meta),this._completed||!m||!T(this._config.complete)||g&&g.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),m||g&&g.meta.paused||this._nextChunk(),g}this._halted=!0},this._sendError=function(o){T(this._config.error)?this._config.error(o):l&&this._config.error&&i.postMessage({workerId:u.WORKER_ID,error:o,finished:!1})}}function d(r){var o;(r=r||{}).chunkSize||(r.chunkSize=u.RemoteChunkSize),w.call(this,r),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(o=new XMLHttpRequest,this._config.withCredentials&&(o.withCredentials=this._config.withCredentials),a||(o.onload=ie(this._chunkLoaded,this),o.onerror=ie(this._chunkError,this)),o.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var c,m=this._config.downloadRequestHeaders;for(c in m)o.setRequestHeader(c,m[c])}var g;this._config.chunkSize&&(g=this._start+this._config.chunkSize-1,o.setRequestHeader("Range","bytes="+this._start+"-"+g));try{o.send(this._config.downloadRequestBody)}catch(k){this._chunkError(k.message)}a&&o.status===0&&this._chunkError()}},this._chunkLoaded=function(){o.readyState===4&&(o.status<200||400<=o.status?this._chunkError():(this._start+=this._config.chunkSize||o.responseText.length,this._finished=!this._config.chunkSize||this._start>=(c=>(c=c.getResponseHeader("Content-Range"))!==null?parseInt(c.substring(c.lastIndexOf("/")+1)):-1)(o),this.parseChunk(o.responseText)))},this._chunkError=function(c){c=o.statusText||c,this._sendError(new Error(c))}}function S(r){(r=r||{}).chunkSize||(r.chunkSize=u.LocalChunkSize),w.call(this,r);var o,c,m=typeof FileReader<"u";this.stream=function(g){this._input=g,c=g.slice||g.webkitSlice||g.mozSlice,m?((o=new FileReader).onload=ie(this._chunkLoaded,this),o.onerror=ie(this._chunkError,this)):o=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var g=this._input,k=(this._config.chunkSize&&(k=Math.min(this._start+this._config.chunkSize,this._input.size),g=c.call(g,this._start,k)),o.readAsText(g,this._config.encoding));m||this._chunkLoaded({target:{result:k}})},this._chunkLoaded=function(g){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(g.target.result)},this._chunkError=function(){this._sendError(o.error)}}function I(r){var o;w.call(this,r=r||{}),this.stream=function(c){return o=c,this._nextChunk()},this._nextChunk=function(){var c,m;if(!this._finished)return c=this._config.chunkSize,o=c?(m=o.substring(0,c),o.substring(c)):(m=o,""),this._finished=!o,this.parseChunk(m)}}function O(r){w.call(this,r=r||{});var o=[],c=!0,m=!1;this.pause=function(){w.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){w.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(g){this._input=g,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){m&&o.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),o.length?this.parseChunk(o.shift()):c=!0},this._streamData=ie(function(g){try{o.push(typeof g=="string"?g:g.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(o.shift()))}catch(k){this._streamError(k)}},this),this._streamError=ie(function(g){this._streamCleanUp(),this._sendError(g)},this),this._streamEnd=ie(function(){this._streamCleanUp(),m=!0,this._streamData("")},this),this._streamCleanUp=ie(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function b(r){var o,c,m,g,k=Math.pow(2,53),W=-k,oe=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,se=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,x=this,z=0,_=0,X=!1,C=!1,R=[],y={data:[],errors:[],meta:{}};function Z(L){return r.skipEmptyLines==="greedy"?L.join("").trim()==="":L.length===1&&L[0].length===0}function B(){if(y&&m&&(ae("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),m=!1),r.skipEmptyLines&&(y.data=y.data.filter(function(v){return!Z(v)})),Y()){let v=function(H,V){T(r.transformHeader)&&(H=r.transformHeader(H,V)),R.push(H)};if(y)if(Array.isArray(y.data[0])){for(var L=0;Y()&&L<y.data.length;L++)y.data[L].forEach(v);y.data.splice(0,1)}else y.data.forEach(v)}function F(v,H){for(var V=r.header?{}:[],A=0;A<v.length;A++){var D=A,M=v[A],M=((le,E)=>(P=>(r.dynamicTypingFunction&&r.dynamicTyping[P]===void 0&&(r.dynamicTyping[P]=r.dynamicTypingFunction(P)),(r.dynamicTyping[P]||r.dynamicTyping)===!0))(le)?E==="true"||E==="TRUE"||E!=="false"&&E!=="FALSE"&&((P=>{if(oe.test(P)&&(P=parseFloat(P),W<P&&P<k))return 1})(E)?parseFloat(E):se.test(E)?new Date(E):E===""?null:E):E)(D=r.header?A>=R.length?"__parsed_extra":R[A]:D,M=r.transform?r.transform(M,D):M);D==="__parsed_extra"?(V[D]=V[D]||[],V[D].push(M)):V[D]=M}return r.header&&(A>R.length?ae("FieldMismatch","TooManyFields","Too many fields: expected "+R.length+" fields but parsed "+A,_+H):A<R.length&&ae("FieldMismatch","TooFewFields","Too few fields: expected "+R.length+" fields but parsed "+A,_+H)),V}var U;y&&(r.header||r.dynamicTyping||r.transform)&&(U=1,!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(F),U=y.data.length):y.data=F(y.data,0),r.header&&y.meta&&(y.meta.fields=R),_+=U)}function Y(){return r.header&&R.length===0}function ae(L,F,U,v){L={type:L,code:F,message:U},v!==void 0&&(L.row=v),y.errors.push(L)}T(r.step)&&(g=r.step,r.step=function(L){y=L,Y()?B():(B(),y.data.length!==0&&(z+=L.data.length,r.preview&&z>r.preview?c.abort():(y.data=y.data[0],g(y,x))))}),this.parse=function(L,F,U){var v=r.quoteChar||'"',v=(r.newline||(r.newline=this.guessLineEndings(L,v)),m=!1,r.delimiter?T(r.delimiter)&&(r.delimiter=r.delimiter(L),y.meta.delimiter=r.delimiter):((v=((H,V,A,D,M)=>{var le,E,P,pe;M=M||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var me=0;me<M.length;me++){for(var ue,Ce=M[me],ee=0,ce=0,K=0,te=(P=void 0,new N({comments:D,delimiter:Ce,newline:V,preview:10}).parse(H)),de=0;de<te.data.length;de++)A&&Z(te.data[de])?K++:(ue=te.data[de].length,ce+=ue,P===void 0?P=ue:0<ue&&(ee+=Math.abs(ue-P),P=ue));0<te.data.length&&(ce/=te.data.length-K),(E===void 0||ee<=E)&&(pe===void 0||pe<ce)&&1.99<ce&&(E=ee,le=Ce,pe=ce)}return{successful:!!(r.delimiter=le),bestDelimiter:le}})(L,r.newline,r.skipEmptyLines,r.comments,r.delimitersToGuess)).successful?r.delimiter=v.bestDelimiter:(m=!0,r.delimiter=u.DefaultDelimiter),y.meta.delimiter=r.delimiter),J(r));return r.preview&&r.header&&v.preview++,o=L,c=new N(v),y=c.parse(o,F,U),B(),X?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return X},this.pause=function(){X=!0,c.abort(),o=T(r.chunk)?"":o.substring(c.getCharIndex())},this.resume=function(){x.streamer._halted?(X=!1,x.streamer.parseChunk(o,!0)):setTimeout(x.resume,3)},this.aborted=function(){return C},this.abort=function(){C=!0,c.abort(),y.meta.aborted=!0,T(r.complete)&&r.complete(y),o=""},this.guessLineEndings=function(H,v){H=H.substring(0,1048576);var v=new RegExp(j(v)+"([^]*?)"+j(v),"gm"),U=(H=H.replace(v,"")).split("\r"),v=H.split(`
`),H=1<v.length&&v[0].length<U[0].length;if(U.length===1||H)return`
`;for(var V=0,A=0;A<U.length;A++)U[A][0]===`
`&&V++;return V>=U.length/2?`\r
`:"\r"}}function j(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function N(r){var o=(r=r||{}).delimiter,c=r.newline,m=r.comments,g=r.step,k=r.preview,W=r.fastMode,oe=null,se=!1,x=r.quoteChar==null?'"':r.quoteChar,z=x;if(r.escapeChar!==void 0&&(z=r.escapeChar),(typeof o!="string"||-1<u.BAD_DELIMITERS.indexOf(o))&&(o=","),m===o)throw new Error("Comment character same as delimiter");m===!0?m="#":(typeof m!="string"||-1<u.BAD_DELIMITERS.indexOf(m))&&(m=!1),c!==`
`&&c!=="\r"&&c!==`\r
`&&(c=`
`);var _=0,X=!1;this.parse=function(C,R,y){if(typeof C!="string")throw new Error("Input must be a string");var Z=C.length,B=o.length,Y=c.length,ae=m.length,L=T(g),F=[],U=[],v=[],H=_=0;if(!C)return ee();if(W||W!==!1&&C.indexOf(x)===-1){for(var V=C.split(c),A=0;A<V.length;A++){if(v=V[A],_+=v.length,A!==V.length-1)_+=c.length;else if(y)return ee();if(!m||v.substring(0,ae)!==m){if(L){if(F=[],pe(v.split(o)),ce(),X)return ee()}else pe(v.split(o));if(k&&k<=A)return F=F.slice(0,k),ee(!0)}}return ee()}for(var D=C.indexOf(o,_),M=C.indexOf(c,_),le=new RegExp(j(z)+j(x),"g"),E=C.indexOf(x,_);;)if(C[_]===x)for(E=_,_++;;){if((E=C.indexOf(x,E+1))===-1)return y||U.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:F.length,index:_}),ue();if(E===Z-1)return ue(C.substring(_,E).replace(le,x));if(x===z&&C[E+1]===z)E++;else if(x===z||E===0||C[E-1]!==z){D!==-1&&D<E+1&&(D=C.indexOf(o,E+1));var P=me((M=M!==-1&&M<E+1?C.indexOf(c,E+1):M)===-1?D:Math.min(D,M));if(C.substr(E+1+P,B)===o){v.push(C.substring(_,E).replace(le,x)),C[_=E+1+P+B]!==x&&(E=C.indexOf(x,_)),D=C.indexOf(o,_),M=C.indexOf(c,_);break}if(P=me(M),C.substring(E+1+P,E+1+P+Y)===c){if(v.push(C.substring(_,E).replace(le,x)),Ce(E+1+P+Y),D=C.indexOf(o,_),E=C.indexOf(x,_),L&&(ce(),X))return ee();if(k&&F.length>=k)return ee(!0);break}U.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:F.length,index:_}),E++}}else if(m&&v.length===0&&C.substring(_,_+ae)===m){if(M===-1)return ee();_=M+Y,M=C.indexOf(c,_),D=C.indexOf(o,_)}else if(D!==-1&&(D<M||M===-1))v.push(C.substring(_,D)),_=D+B,D=C.indexOf(o,_);else{if(M===-1)break;if(v.push(C.substring(_,M)),Ce(M+Y),L&&(ce(),X))return ee();if(k&&F.length>=k)return ee(!0)}return ue();function pe(K){F.push(K),H=_}function me(K){var te=0;return te=K!==-1&&(K=C.substring(E+1,K))&&K.trim()===""?K.length:te}function ue(K){return y||(K===void 0&&(K=C.substring(_)),v.push(K),_=Z,pe(v),L&&ce()),ee()}function Ce(K){_=K,pe(v),v=[],M=C.indexOf(c,_)}function ee(K){if(r.header&&!R&&F.length&&!se){var te=F[0],de={},ke=new Set(te);let Me=!1;for(let ye=0;ye<te.length;ye++){let fe=te[ye];if(de[fe=T(r.transformHeader)?r.transformHeader(fe,ye):fe]){let Ee,Oe=de[fe];for(;Ee=fe+"_"+Oe,Oe++,ke.has(Ee););ke.add(Ee),te[ye]=Ee,de[fe]++,Me=!0,(oe=oe===null?{}:oe)[Ee]=fe}else de[fe]=1,te[ye]=fe;ke.add(fe)}Me&&console.warn("Duplicate headers found and renamed."),se=!0}return{data:F,errors:U,meta:{delimiter:o,linebreak:c,aborted:X,truncated:!!K,cursor:H+(R||0),renamedHeaders:oe}}}function ce(){g(ee()),F=[],U=[]}},this.abort=function(){X=!0},this.getCharIndex=function(){return _}}function $(r){var o=r.data,c=f[o.workerId],m=!1;if(o.error)c.userError(o.error,o.file);else if(o.results&&o.results.data){var g={abort:function(){m=!0,q(o.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Q,resume:Q};if(T(c.userStep)){for(var k=0;k<o.results.data.length&&(c.userStep({data:o.results.data[k],errors:o.results.errors,meta:o.results.meta},g),!m);k++);delete o.results}else T(c.userChunk)&&(c.userChunk(o.results,g,o.file),delete o.results)}o.finished&&!m&&q(o.workerId,o.results)}function q(r,o){var c=f[r];T(c.userComplete)&&c.userComplete(o),c.terminate(),delete f[r]}function Q(){throw new Error("Not implemented.")}function J(r){if(typeof r!="object"||r===null)return r;var o,c=Array.isArray(r)?[]:{};for(o in r)c[o]=J(r[o]);return c}function ie(r,o){return function(){r.apply(o,arguments)}}function T(r){return typeof r=="function"}return u.parse=function(r,o){var c=(o=o||{}).dynamicTyping||!1;if(T(c)&&(o.dynamicTypingFunction=c,c={}),o.dynamicTyping=c,o.transform=!!T(o.transform)&&o.transform,!o.worker||!u.WORKERS_SUPPORTED)return c=null,u.NODE_STREAM_INPUT,typeof r=="string"?(r=(m=>m.charCodeAt(0)!==65279?m:m.slice(1))(r),c=new(o.download?d:I)(o)):r.readable===!0&&T(r.read)&&T(r.on)?c=new O(o):(i.File&&r instanceof File||r instanceof Object)&&(c=new S(o)),c.stream(r);(c=(()=>{var m;return!!u.WORKERS_SUPPORTED&&(m=(()=>{var g=i.URL||i.webkitURL||null,k=n.toString();return u.BLOB_URL||(u.BLOB_URL=g.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",k,")();"],{type:"text/javascript"})))})(),(m=new i.Worker(m)).onmessage=$,m.id=p++,f[m.id]=m)})()).userStep=o.step,c.userChunk=o.chunk,c.userComplete=o.complete,c.userError=o.error,o.step=T(o.step),o.chunk=T(o.chunk),o.complete=T(o.complete),o.error=T(o.error),delete o.worker,c.postMessage({input:r,config:o,workerId:c.id})},u.unparse=function(r,o){var c=!1,m=!0,g=",",k=`\r
`,W='"',oe=W+W,se=!1,x=null,z=!1,_=((()=>{if(typeof o=="object"){if(typeof o.delimiter!="string"||u.BAD_DELIMITERS.filter(function(R){return o.delimiter.indexOf(R)!==-1}).length||(g=o.delimiter),typeof o.quotes!="boolean"&&typeof o.quotes!="function"&&!Array.isArray(o.quotes)||(c=o.quotes),typeof o.skipEmptyLines!="boolean"&&typeof o.skipEmptyLines!="string"||(se=o.skipEmptyLines),typeof o.newline=="string"&&(k=o.newline),typeof o.quoteChar=="string"&&(W=o.quoteChar),typeof o.header=="boolean"&&(m=o.header),Array.isArray(o.columns)){if(o.columns.length===0)throw new Error("Option columns is empty");x=o.columns}o.escapeChar!==void 0&&(oe=o.escapeChar+W),o.escapeFormulae instanceof RegExp?z=o.escapeFormulae:typeof o.escapeFormulae=="boolean"&&o.escapeFormulae&&(z=/^[=+\-@\t\r].*$/)}})(),new RegExp(j(W),"g"));if(typeof r=="string"&&(r=JSON.parse(r)),Array.isArray(r)){if(!r.length||Array.isArray(r[0]))return X(null,r,se);if(typeof r[0]=="object")return X(x||Object.keys(r[0]),r,se)}else if(typeof r=="object")return typeof r.data=="string"&&(r.data=JSON.parse(r.data)),Array.isArray(r.data)&&(r.fields||(r.fields=r.meta&&r.meta.fields||x),r.fields||(r.fields=Array.isArray(r.data[0])?r.fields:typeof r.data[0]=="object"?Object.keys(r.data[0]):[]),Array.isArray(r.data[0])||typeof r.data[0]=="object"||(r.data=[r.data])),X(r.fields||[],r.data||[],se);throw new Error("Unable to serialize unrecognized input");function X(R,y,Z){var B="",Y=(typeof R=="string"&&(R=JSON.parse(R)),typeof y=="string"&&(y=JSON.parse(y)),Array.isArray(R)&&0<R.length),ae=!Array.isArray(y[0]);if(Y&&m){for(var L=0;L<R.length;L++)0<L&&(B+=g),B+=C(R[L],L);0<y.length&&(B+=k)}for(var F=0;F<y.length;F++){var U=(Y?R:y[F]).length,v=!1,H=Y?Object.keys(y[F]).length===0:y[F].length===0;if(Z&&!Y&&(v=Z==="greedy"?y[F].join("").trim()==="":y[F].length===1&&y[F][0].length===0),Z==="greedy"&&Y){for(var V=[],A=0;A<U;A++){var D=ae?R[A]:A;V.push(y[F][D])}v=V.join("").trim()===""}if(!v){for(var M=0;M<U;M++){0<M&&!H&&(B+=g);var le=Y&&ae?R[M]:M;B+=C(y[F][le],M)}F<y.length-1&&(!Z||0<U&&!H)&&(B+=k)}}return B}function C(R,y){var Z,B;return R==null?"":R.constructor===Date?JSON.stringify(R).slice(1,25):(B=!1,z&&typeof R=="string"&&z.test(R)&&(R="'"+R,B=!0),Z=R.toString().replace(_,oe),(B=B||c===!0||typeof c=="function"&&c(R,y)||Array.isArray(c)&&c[y]||((Y,ae)=>{for(var L=0;L<ae.length;L++)if(-1<Y.indexOf(ae[L]))return!0;return!1})(Z,u.BAD_DELIMITERS)||-1<Z.indexOf(g)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?W+Z+W:Z)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!a&&!!i.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=N,u.ParserHandle=b,u.NetworkStreamer=d,u.FileStreamer=S,u.StringStreamer=I,u.ReadableStreamStreamer=O,i.jQuery&&((s=i.jQuery).fn.parse=function(r){var o=r.config||{},c=[];return this.each(function(k){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var W=0;W<this.files.length;W++)c.push({file:this.files[W],inputElem:this,instanceConfig:s.extend({},o)})}),m(),this;function m(){if(c.length===0)T(r.complete)&&r.complete();else{var k,W,oe,se,x=c[0];if(T(r.before)){var z=r.before(x.file,x.inputElem);if(typeof z=="object"){if(z.action==="abort")return k="AbortError",W=x.file,oe=x.inputElem,se=z.reason,void(T(r.error)&&r.error({name:k},W,oe,se));if(z.action==="skip")return void g();typeof z.config=="object"&&(x.instanceConfig=s.extend(x.instanceConfig,z.config))}else if(z==="skip")return void g()}var _=x.instanceConfig.complete;x.instanceConfig.complete=function(X){T(_)&&_(X,x.file,x.inputElem),g()},u.parse(x.file,x.instanceConfig)}}function g(){c.splice(0,1),m()}}),l&&(i.onmessage=function(r){r=r.data,u.WORKER_ID===void 0&&r&&(u.WORKER_ID=r.workerId),typeof r.input=="string"?i.postMessage({workerId:u.WORKER_ID,results:u.parse(r.input,r.config),finished:!0}):(i.File&&r.input instanceof File||r.input instanceof Object)&&(r=u.parse(r.input,r.config))&&i.postMessage({workerId:u.WORKER_ID,results:r,finished:!0})}),(d.prototype=Object.create(w.prototype)).constructor=d,(S.prototype=Object.create(w.prototype)).constructor=S,(I.prototype=Object.create(I.prototype)).constructor=I,(O.prototype=Object.create(w.prototype)).constructor=O,u})}(we)),we.exports}var jt=At();const Dt=Ze(jt),Ut=async({url:e,setIsLoading:t,setError:n,setHeaders:i,setCsvData:s})=>{if(e){t(!0),n(null);try{const a=await fetch(e);if(!a.ok)throw new Error(`Failed to fetch CSV: ${a.status}`);const l=await a.text();Dt.parse(l,{complete:f=>{const p=f.data;p.length>0&&(i(p[0]),s(p)),t(!1)},error:f=>{n(`Error parsing CSV: ${f.message}`),t(!1)}})}catch(a){n(`Error fetching CSV: ${a instanceof Error?a.message:String(a)}`),t(!1)}}},Nt=({data:e,latField:t,lngField:n,nameField:i,descField:s})=>({type:"FeatureCollection",features:e.map(p=>{const u=parseFloat(p[t]),w=parseFloat(p[n]);return isNaN(u)||isNaN(w)?null:{type:"Feature",geometry:{type:"Point",coordinates:[w,u]},properties:{name:i?p[i]:"",description:s?p[s]:""}}}).filter(p=>p!==null)}),Ht=({params:e,updateCustomProp:t,className:n})=>{var S,I;console.log("params",e);const[i,s]=h.useState(null),[a,l]=h.useState(!0),[f,p]=h.useState(null),[u,w]=h.useState(null);h.useEffect(()=>{(async()=>{try{if(e.dataURL&&e.dataURL.length>10&&e.latField!==""&&e.lngField!==""){const b=await Ft(e.dataURL),j=Nt({data:b,latField:e.latField??"",lngField:e.lngField??"",nameField:e.nameField,descField:e.descField});s(j),l(!1)}}catch(b){console.error("Failed to parse mapFields parameter:",b),p("Invalid mapFields parameter in URL"),l(!1)}})()},[e]);const d=h.useCallback(O=>{var j;const b=(j=O.features)==null?void 0:j[0];if(b&&b.geometry.type==="Point"){const[N,$]=b.geometry.coordinates;w({longitude:N,latitude:$,name:b.properties.name,description:b.properties.description})}},[]);return G.jsxs("div",{className:"relative "+n,children:[a&&G.jsx("div",{className:"flex items-center justify-center absolute z-10 h-full w-full bg-white bg-opacity-80",children:G.jsxs("div",{className:"flex flex-col items-center gap-2",children:[G.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),G.jsx("p",{className:"text-gray-700 font-medium",children:"Loading map data..."})]})}),f&&G.jsx("div",{className:"flex items-center justify-center absolute z-10 h-full w-full bg-white bg-opacity-80",children:G.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[G.jsx("p",{className:"font-bold",children:"Error"}),G.jsx("p",{children:f})]})}),!a&&G.jsxs(rt,{initialViewState:{longitude:Number((S=e.mapCenter)==null?void 0:S[0])||0,latitude:Number((I=e.mapCenter)==null?void 0:I[1])||0,zoom:Number(e.mapZoom)||1,pitch:Number(e.mapPitch)||0,bearing:Number(e.mapBearing)||0},style:{width:"100%",height:"100%"},mapStyle:bt[e.mapStyle],interactiveLayerIds:i?["points"]:[],onClick:d,onMouseEnter:O=>{var b,j;((j=(b=O.features)==null?void 0:b[0])==null?void 0:j.layer.id)==="points"&&(O.target.getCanvas().style.cursor="pointer")},onMouseLeave:O=>{O.target.getCanvas().style.cursor=""},attributionControl:{customAttribution:"Â© <a href='https://geomapi.com/'>geomapi.com</a> <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors"},onIdle:O=>{if(t&&t instanceof Function){const b=O.target,j=b.getCenter(),N=b.getZoom().toFixed(2);console.log("Center:",j,"Zoom:",N),t("mapZoom",N),t("mapCenter",[+j.lng.toFixed(4),+j.lat.toPrecision(4)]),t("mapPitch",b.getPitch().toFixed(2)),t("mapBearing",b.getBearing().toFixed(2))}},children:[G.jsx(ct,{position:"top-right"}),i&&G.jsx(yt,{id:"points-source",type:"geojson",data:i,children:G.jsx(Et,{id:"points",type:"circle",source:"points-source",paint:{"circle-radius":6,"circle-color":e.pinColor?`#${e.pinColor}`:"#007cbf","circle-stroke-width":2,"circle-stroke-color":"#ffffff","circle-opacity":.9}})}),u&&G.jsx(ot,{longitude:u.longitude,latitude:u.latitude,anchor:"bottom",onClose:()=>w(null),closeButton:!0,closeOnClick:!1,className:"map-popup",children:G.jsxs("div",{className:"p-1",children:[G.jsx("h3",{className:"font-bold text-gray-800",children:u.name}),u.description&&G.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.description})]})})]})]})};export{Ht as M,bt as a,zt as d,Ut as f};
